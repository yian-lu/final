$(document).ready(function(){var e=!1,a=$(".image-container");$(".text-container").on("mousedown",".text-editor",function(a){"move"==$(this).css("cursor")?(e=!0,movingTextarea=a.target,$(movingTextarea).css({"background-color":"rgba(192, 192, 0, 0.2)"}),starting={X:a.pageX,Y:a.pageY}):e=!1}).on("mousemove",".text-editor",function(a){0==e?a.offsetX<5||a.offsetX>$(this).innerWidth()-5||a.offsetY<5||a.offsetY>$(this).innerHeight()-5?$(".text-editor").css({cursor:"move"}):$(".text-editor").css({cursor:"text"}):(delta={X:a.pageX-starting.X,Y:a.pageY-starting.Y},final={X:$(movingTextarea).position().left+delta.X,Y:$(movingTextarea).position().top+delta.Y},$(movingTextarea).css({left:final.X}),$(movingTextarea).css({top:final.Y}),starting={X:a.pageX,Y:a.pageY})}).on("mouseup",".text-editor",function(a){e=!1,$(movingTextarea).css({"background-color":"rgba(192, 192, 192, 0)"})}),$(".text-container").on("click",".text-editor",function(e){if("text"==$(this).css("cursor")){activeTextarea=e.target,$(".toolbar-btn").removeClass("pressed"),$(activeTextarea).hasClass("ft-kai")?$("#btn001").addClass("pressed"):$(activeTextarea).hasClass("ft-ming")&&$("#btn002").addClass("pressed"),$(activeTextarea).hasClass("ft-sm")?$("#btn003").addClass("pressed"):$(activeTextarea).hasClass("ft-md")?$("#btn004").addClass("pressed"):$(activeTextarea).hasClass("ft-lg")&&$("#btn005").addClass("pressed"),$(activeTextarea).hasClass("ft-bd")&&$("#btn006").addClass("pressed"),$(activeTextarea).hasClass("ft-it")&&$("#btn007").addClass("pressed"),$(activeTextarea).hasClass("ft-ul")&&$("#btn008").addClass("pressed");var t=$(".text-popup").outerWidth(!0),s=$(".text-popup").outerHeight(!0),r=Math.max(e.pageX-10,a.offset().left),i=(r=Math.min(r,a.offset().left+1.5*a.outerHeight(!0)-t),Math.max(e.pageY-10,a.offset().top));i=Math.min(i,a.offset().top+a.outerHeight(!0)-s);$(".text-popup").css({display:"grid",top:i,left:r})}}),$(document).mouseup(function(e){$(".text-popup").is(e.target)||0!==$(".text-popup").has(e.target).length||$(".text-popup").css({display:"none"})}),$(".text-popup").on("click","#btn001",function(){$(activeTextarea).addClass("ft-kai"),$(activeTextarea).removeClass("ft-ming")}).on("click","#btn002",function(){$(activeTextarea).addClass("ft-ming"),$(activeTextarea).removeClass("ft-kai")}).on("click","#btn003",function(){$(activeTextarea).addClass("ft-sm"),$(activeTextarea).removeClass("ft-md"),$(activeTextarea).removeClass("ft-lg")}).on("click","#btn004",function(){$("#btn004").addClass("pressed"),$("#btn003").removeClass("pressed"),$("#btn005").removeClass("pressed"),$(activeTextarea).addClass("ft-md"),$(activeTextarea).removeClass("ft-sm"),$(activeTextarea).removeClass("ft-lg")}).on("click","#btn005",function(){$("#btn005").addClass("pressed"),$("#btn003").removeClass("pressed"),$("#btn004").removeClass("pressed"),$(activeTextarea).addClass("ft-lg"),$(activeTextarea).removeClass("ft-sm"),$(activeTextarea).removeClass("ft-md")}).on("click","#btn006",function(){$(this).hasClass("pressed")?($(this).removeClass("pressed"),$(activeTextarea).removeClass("ft-bd")):($(this).addClass("pressed"),$(activeTextarea).addClass("ft-bd"))}).on("click","#btn007",function(){$(this).hasClass("pressed")?($(this).removeClass("pressed"),$(activeTextarea).removeClass("ft-it")):($(this).addClass("pressed"),$(activeTextarea).addClass("ft-it"))}).on("click","#btn008",function(){$(this).hasClass("pressed")?($(this).removeClass("pressed"),$(activeTextarea).removeClass("ft-ul")):($(this).addClass("pressed"),$(activeTextarea).addClass("ft-ul"))}).on("click","#btn009",function(){$(activeTextarea).addClass("ft-white"),$(activeTextarea).removeClass("ft-black"),$(activeTextarea).removeClass("ft-red"),$(activeTextarea).removeClass("ft-yellow"),$(activeTextarea).removeClass("ft-green"),$(activeTextarea).removeClass("ft-cyan"),$(activeTextarea).removeClass("ft-blue"),$(activeTextarea).removeClass("ft-magenta")}).on("click","#btn010",function(){$(activeTextarea).addClass("ft-black"),$(activeTextarea).removeClass("ft-white"),$(activeTextarea).removeClass("ft-red"),$(activeTextarea).removeClass("ft-yellow"),$(activeTextarea).removeClass("ft-green"),$(activeTextarea).removeClass("ft-cyan"),$(activeTextarea).removeClass("ft-blue"),$(activeTextarea).removeClass("ft-magenta")}).on("click","#btn011",function(){$(activeTextarea).addClass("ft-red"),$(activeTextarea).removeClass("ft-white"),$(activeTextarea).removeClass("ft-black"),$(activeTextarea).removeClass("ft-yellow"),$(activeTextarea).removeClass("ft-green"),$(activeTextarea).removeClass("ft-cyan"),$(activeTextarea).removeClass("ft-blue"),$(activeTextarea).removeClass("ft-magenta")}).on("click","#btn012",function(){$(activeTextarea).addClass("ft-yellow"),$(activeTextarea).removeClass("ft-white"),$(activeTextarea).removeClass("ft-black"),$(activeTextarea).removeClass("ft-red"),$(activeTextarea).removeClass("ft-green"),$(activeTextarea).removeClass("ft-cyan"),$(activeTextarea).removeClass("ft-blue"),$(activeTextarea).removeClass("ft-magenta")}).on("click","#btn013",function(){$(activeTextarea).addClass("ft-green"),$(activeTextarea).removeClass("ft-white"),$(activeTextarea).removeClass("ft-black"),$(activeTextarea).removeClass("ft-red"),$(activeTextarea).removeClass("ft-yellow"),$(activeTextarea).removeClass("ft-cyan"),$(activeTextarea).removeClass("ft-blue"),$(activeTextarea).removeClass("ft-magenta")}).on("click","#btn014",function(){$(activeTextarea).addClass("ft-cyan"),$(activeTextarea).removeClass("ft-white"),$(activeTextarea).removeClass("ft-black"),$(activeTextarea).removeClass("ft-red"),$(activeTextarea).removeClass("ft-yellow"),$(activeTextarea).removeClass("ft-green"),$(activeTextarea).removeClass("ft-blue"),$(activeTextarea).removeClass("ft-magenta")}).on("click","#btn015",function(){$(activeTextarea).addClass("ft-blue"),$(activeTextarea).removeClass("ft-white"),$(activeTextarea).removeClass("ft-black"),$(activeTextarea).removeClass("ft-red"),$(activeTextarea).removeClass("ft-yellow"),$(activeTextarea).removeClass("ft-green"),$(activeTextarea).removeClass("ft-cyan"),$(activeTextarea).removeClass("ft-magenta")}).on("click","#btn016",function(){$(activeTextarea).addClass("ft-magenta"),$(activeTextarea).removeClass("ft-white"),$(activeTextarea).removeClass("ft-black"),$(activeTextarea).removeClass("ft-red"),$(activeTextarea).removeClass("ft-yellow"),$(activeTextarea).removeClass("ft-green"),$(activeTextarea).removeClass("ft-cyan"),$(activeTextarea).removeClass("ft-blue")}).on("click",".toolbar-btn",function(){$(".text-popup").css({display:"none"})}),$(".reset-btn").click(function(){$(".image-container").css("background-image","url('img/bg001.jpg')"),$(".text-editor").remove(),$(".text-popup").css({display:"none"})}),counter=2,$(".text-btn").click(function(){$newDiv=$("<div>請輸入文字</div>"),$newDiv.attr("class","text-editor ft-kai ft-md"),$newDiv.attr("id","text"+counter++),$newDiv.attr("contentEditable","true"),$(".text-container").append($newDiv),adjustFontSize()}),$(".btn").on("click",".download-btn",function(){window.scrollTo(0,0),html2canvas($("#bg")[0],{useCORS:!0,allowTaint:!0}).then(function(e){$(e).appendTo(".canvas"),$(".canvas").css({display:"block"})})}),$(".bg").each(function(e){var a=e+1;$("#bg00"+a).click(function(){$(".image-container").css("background-image","url('img/bg00"+a+".jpg')")})})});